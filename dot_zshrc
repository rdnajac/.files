# .zshrc

# use fish without overriding the default shell
if [[ -o interactive && -z "$FISH_VERSION" ]]; then
  exec /opt/homebrew/bin/fish -l
fi

setopt interactivecomments

[ -f "$HOME"/.bash_aliases ] && . "$HOME"/.bash_aliases

eval "$(chezmoi completion zsh)"
eval "$(thefuck --alias)"
eval "$(zoxide init zsh)"

# Section: History {{{
setopt APPEND_HISTORY
setopt INC_APPEND_HISTORY SHARE_HISTORY
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_REDUCE_BLANKS

# see `/private/etc/zshrc` for defaults
# export HISTFILE="${ZDOTDIR:-$HOME}/.zsh_history"
# export HISTSIZE=10000
# export SAVEHIST=10000

# Don't pollute $HOME with history files
alias wget='wget --no-hsts'
export LESSHISTFILE=-
# }}}

# Section: Completion {{{
FPATH=$(brew --prefix)/share/zsh-completions:$FPATH
autoload -Uz compinit && compinit

export ZSH_CACHE_DIR="$HOME/.cache/zsh"
mkdir -p "$ZSH_CACHE_DIR"
zstyle ':completion:*' cache-path "$ZSH_CACHE_DIR"

zstyle ':completion:*:rsync:*' remote-access yes
zstyle ':completion:*:rsync:*' tag-order hosts remote-directories files

# TODO: cominit?
# compdef _vim nv
# }}}

# Section: Executables {{{
# override macOS tools with GNU versions if available
alias awk="${HOMEBREW_PREFIX}/bin/gawk"
# if the names are the same, rely on the `$PATH` order
# alias ctags="${HOMEBREW_PREFIX}/bin/ctags"
# }}}

# Load additional zsh configs
if [ -d "$ZDOTDIR" ]; then
# `(N)` is a zsh glob qualifier; bash uses `shopt -s nullglob`
	for f in "$ZDOTDIR"/*.zsh(N); do
		. "$f"
	done
else 
	echo 'no ZDOTDIR set, skipping loading additional zsh configs'
fi

# >>> mamba initialize >>>
# !! Contents within this block are managed by 'micromamba shell init' !!
export MAMBA_EXE='/Users/rdn/.local/bin/micromamba';
export MAMBA_ROOT_PREFIX='/Users/rdn/.cache/micromamba';
__mamba_setup="$("$MAMBA_EXE" shell hook --shell zsh --root-prefix "$MAMBA_ROOT_PREFIX" 2> /dev/null)"
if [ $? -eq 0 ]; then
	eval "$__mamba_setup"
else
	alias micromamba="$MAMBA_EXE"  # Fallback on help from micromamba activate
fi
unset __mamba_setup
# <<< mamba initialize <<<

# vim:fdm=marker:fdl=0
